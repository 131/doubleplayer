!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";var DoubleVideo=require("./doublevideo"),DoublePlayer={start:function(video_url,container){return new DoubleVideo(video_url,container)}};module.exports=DoublePlayer},{"./doublevideo":2}],2:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),shaderFs="\n  precision mediump float;\n  uniform sampler2D sm;\n  varying vec2 tx;\n\n  void main(void) {\n    gl_FragColor=texture2D(sm,tx);\n  }\n",shaderVs="\n  attribute vec2 vx;\n  varying vec2 tx;\n  uniform float xFactor;\n  uniform float imgFac;\n\n\n  void main(void) {\n    float vxx   = vx.x * ( 1.0 - xFactor) + xFactor;\n    gl_Position = vec4((vx.x*2.0*xFactor-1.0)*imgFac + (1.0-imgFac)*(vxx*2.0-1.0)  , 1.0-vx.y*2.0, 0 , 1);\n    tx          = vec2((vx.x*xFactor/2.0)*imgFac + (1.0-imgFac)*(vxx / 2.0 + 0.5) , vx.y);\n  }\n",$n=require("udom/element/create"),requestAnimationFrame=require("udom/window/requestAnimationFrame"),DoubleVideo=function(){function DoubleVideo(video_url,container){var _this=this;_classCallCheck(this,DoubleVideo);var video=$n("video",{loop:!0,autoplay:!0});console.log("Video src is : ",video_url),this.container=container;var videos=container.getElementsByTagName("video");videos.length>0&&(videos[0].pause(),videos[0].src=""),video.src="",this.container.innerHTML="";var ready=!1;video.addEventListener("loadedmetadata",function(){if(ready)return void console.log("META DATA ALREADY LOADED !");console.log("Loadedd metadata"),ready=!0,_this.video=video,_this.video.id="Myvideo",_this.video_width=video.videoWidth,_this.video_height=video.videoHeight;var canvas=_this.prepareCanvas(),gl=_this.initWebGL(canvas);_this.initShaders(gl),_this.initBuffers(gl),_this.gl=gl,_this.timerCallback()}),this.timerCallback=this.timerCallback.bind(this),requestAnimationFrame(function(){video.src=video_url+"#"+Math.random(),video.play()})}return _createClass(DoubleVideo,[{key:"initShaders",value:function(gl){var fragmentShader=this.getShader(gl,shaderFs,gl.FRAGMENT_SHADER),vertexShader=this.getShader(gl,shaderVs,gl.VERTEX_SHADER);if(this.shaderProgram=gl.createProgram(),gl.attachShader(this.shaderProgram,vertexShader),gl.attachShader(this.shaderProgram,fragmentShader),gl.linkProgram(this.shaderProgram),!gl.getProgramParameter(this.shaderProgram,gl.LINK_STATUS))throw"Unable to initialize the shader program: "+gl.getProgramInfoLog(this.shaderProgram);gl.useProgram(this.shaderProgram),this.vx_ptr=gl.getAttribLocation(this.shaderProgram,"vx"),gl.enableVertexAttribArray(this.vx_ptr),gl.uniform1i(gl.getUniformLocation(this.shaderProgram,"sm"),0)}},{key:"getShader",value:function(gl,theSource,type){var shader=gl.createShader(type);return gl.shaderSource(shader,theSource),gl.compileShader(shader),gl.getShaderParameter(shader,gl.COMPILE_STATUS)?shader:(alert("An error occurred compiling the shaders: "+gl.getShaderInfoLog(shader)),null)}},{key:"initBuffers",value:function(gl){this.vx=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.vx),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array([0,0,1,0,1,1,0,1]),gl.STATIC_DRAW),this.ix=gl.createBuffer(),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.ix),gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3]),gl.STATIC_DRAW),this.tex=gl.createTexture(),gl.bindTexture(gl.TEXTURE_2D,this.tex),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR)}},{key:"initWebGL",value:function(canvas){var gl=canvas.getContext("experimental-webgl");return gl.clearColor(0,0,0,1),gl.clearDepth(1),gl.enable(gl.DEPTH_TEST),gl.depthFunc(gl.LEQUAL),gl}},{key:"prepareCanvas",value:function(){var _this2=this,canvas=$n("canvas",{width:this.video_width/2,height:this.video_height});return canvas.style.width=canvas.style.height="100%",this.container.appendChild(canvas),this.delimiter=.5,canvas.addEventListener("mousemove",function(e){var x=e.clientX;x/=_this2.container.offsetWidth,_this2.delimiter=x},!1),canvas.addEventListener("touchstart",function(e){}),canvas.addEventListener("touchmove",function(e){var x=e.touches[0].clientX;x/=_this2.container.offsetWidth,_this2.delimiter=x},!1),this.uTimeout=Math.random(),window.globalTimeout=this.uTimeout,canvas}},{key:"timerCallback",value:function(){return this.uTimeout!=window.globalTimeout?void console.log("//kthxby"):(this.computeFrame(),void requestAnimationFrame(this.timerCallback))}},{key:"computeFrame",value:function(){var gl=this.gl;gl.clear(gl.COLOR_BUFFER_BIT),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,this.tex),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGB,gl.RGB,gl.UNSIGNED_BYTE,this.video);var half=this.video_width/2,x=Math.max(1,Math.min(half-1,half*this.delimiter)),xPos=x/this.video_width*2,xUniform=gl.getUniformLocation(this.shaderProgram,"xFactor");gl.uniform1f(xUniform,xPos);var xUniform=gl.getUniformLocation(this.shaderProgram,"imgFac");gl.uniform1f(xUniform,0),gl.bindBuffer(gl.ARRAY_BUFFER,this.vx),gl.vertexAttribPointer(this.vx_ptr,2,gl.FLOAT,!1,0,0),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.ix),gl.drawElements(gl.TRIANGLES,6,gl.UNSIGNED_SHORT,0);var xUniform=gl.getUniformLocation(this.shaderProgram,"xFactor");gl.uniform1f(xUniform,xPos);var xUniform=gl.getUniformLocation(this.shaderProgram,"imgFac");gl.uniform1f(xUniform,1),gl.bindBuffer(gl.ARRAY_BUFFER,this.vx),gl.vertexAttribPointer(this.vx_ptr,2,gl.FLOAT,!1,0,0),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.ix),gl.drawElements(gl.TRIANGLES,6,gl.UNSIGNED_SHORT,0)}}]),DoubleVideo}();module.exports=DoubleVideo},{"udom/element/create":3,"udom/window/requestAnimationFrame":6}],3:[function(require,module,exports){"use strict";var forIn=require("mout/object/forIn");module.exports=function(tagname,attrs){var foo=document.createElement(tagname);return forIn(attrs||{},function(value,attrname){foo[attrname]=value}),foo}},{"mout/object/forIn":4}],4:[function(require,module,exports){function checkDontEnum(){_dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],_hasDontEnumBug=!0;for(var key in{toString:null})_hasDontEnumBug=!1}function forIn(obj,fn,thisObj){var key,i=0;null==_hasDontEnumBug&&checkDontEnum();for(key in obj)if(exec(fn,obj,key,thisObj)===!1)break;if(_hasDontEnumBug)for(var ctor=obj.constructor,isProto=!!ctor&&obj===ctor.prototype;(key=_dontEnums[i++])&&("constructor"===key&&(isProto||!hasOwn(obj,key))||obj[key]===Object.prototype[key]||exec(fn,obj,key,thisObj)!==!1););}function exec(fn,obj,key,thisObj){return fn.call(thisObj,obj[key],key,obj)}var _hasDontEnumBug,_dontEnums,hasOwn=require("./hasOwn");module.exports=forIn},{"./hasOwn":5}],5:[function(require,module,exports){function hasOwn(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=hasOwn},{}],6:[function(require,module,exports){"use strict";module.exports=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(callback){window.setTimeout(callback,1e3/60)}}()},{}],7:[function(require,module,exports){"use strict";window.DoublePlayer=require("..")},{"..":1}]},{},[7]);